/var/www/html;/var/www/html;/var/www/html;/var/www/html;/var/www/html;/var/www/html;$(document).ready(function(){var catalog=x4.getModule('catalogFront');var pages=x4.getModule('pagesFront');function renderFilterResults(formid){serialized=$('#'+formid).serialize();serialized=decodeURIComponent(serialized);serialized=serialized.replace('tovarbase.firstname','Base');index=location.pathname.indexOf('/--');if(index!=-1){pathname=location.pathname.slice(0,index)}else{pathname=location.pathname}
gpath=location.host+pathname+'/?'+serialized;gpath=gpath.replace(/\/\//g,"/");var url=location.protocol+'//'+gpath;$('.catalogListHolder').css('opacity',0.5);res=pages.renderSlot(url,['center'],function(xres,bres){slots=bres.result.slots;fragment=document.createDocumentFragment();var range=document.createRange();range.selectNode(document.body);var df=range.createContextualFragment(slots.center);table=$(df).find('.col').html();$('.col .table').replaceWith(table);$('.col .table').css('opacity',1);catalog.execute({buildUrlTransformation:{url:url}});window.history.replaceState("object or string","Title",catalog.connector.result.url)})}
$(document).on("change","#mainFilter #lastEvent",function(e){now=Math.floor(Date.now()/1000);if($(this).val()==''){past=0}else{past=now-$(this).val()}
$('#fmin').val(past);$('#fmax').val(now)});$('#mainFilter .reset_filter_btn').click(function(){catalog.execute({clearSessionFilter:!0})});$(document).on("change",'#sortMenu',function(){document.location.href=$(this).val()});$(document).on("keyup","#mainFilter input",function(e){renderFilterResults('mainFilter')});$(document).on("click","#mainFilter input",function(e){renderFilterResults('mainFilter')});$(document).on("change","#mainFilter select",function(e){renderFilterResults('mainFilter')})});/var/www/html;/var/www/html;/var/www/html;moduleRegister.pushModule('ishop');var ishopFront=new Class({Extends:x4FrontModule,preventJquery:!1,constructor:function(){this.parent('ishop')},setPaySystem:function(paysystem){this.connector.execute({set_paysystem:{paysystem:paysystem}})},addToCart:function(id,count,isSku,extendedFields,callback){if(!id)return;obj={id:id,count:count};if(extendedFields){obj.extendedData=extendedFields}
if(isSku){obj.isSku=isSku}
this.connector.execute({addProductToCart:obj},callback);if(!callback)return this.connector.result.cart},calculateDelivery:function(deliveryId){this.connector.execute({calculateCartWithDelivery:{id:deliveryId}});return this.connector.result.delivery},setOrderData:function(data){this.connector.execute({setOrderData:{data:data}})},getCartInfo:function(){this.connector.execute({getCartInfo:!0});return this.connector.result.cartInfo},getLastCartItems:function(){this.connector.execute({getLastCartItems:!0});return this.connector.result.cartItems},getCurrentCurrency:function(){result=this.connector.execute({getCurrentCurrency:!0});return this.connector.result.currency},getCartItems:function(){this.connector.execute({getCart:!0});return this.connector.result.cartItems},jqueryRun:function(){if(this.preventJquery)return;$.fn.ishopToBasket=function(options){var defaults={count:1,idAttribute:'id',onGoodAdded:null,extDataFunc:null,countDataFunc:null,onFinishedFunc:null,isSKUFunc:null,syncAddToBasket:!0,basketContainer:'.basket-container',basketCountSelector:'.basket-count',basketAllCountSelector:'.basket-count',basketSumSelector:'.basket-sum',basketElementTemplate:'<li><a>{details.props.Name}</a> <span>{count}</span> <span>{details.props.price}</span> <span>{priceSum}</span></li>'};console.log(options);var options=$.extend(defaults,options);console.log(options);$(this).click(function(e){e.preventDefault();ext={};if(jQuery.isFunction(options.extDataFunc))ext=options.extDataFunc(this);if(jQuery.isFunction(options.countDataFunc))options.count=options.countDataFunc(this);if(jQuery.isFunction(options.isSKUFunc)){isSKU=options.isSKUFunc(this)}else{isSKU=!1}
cart=ishop.addToCart($(this).attr(options.idAttribute),options.count,isSKU,ext,options.onGoodAdded);if(!options.onGoodAdded){$(options.basketCountSelector).html(cart.itemsCount);$(options.basketAllCountSelector).html(cart.allCount);$(options.basketSumSelector).html(cart.orderSum);if(options.syncAddToBasket){items=ishop.getCartItems();if(options.basketContainer){var container=$(options.basketContainer);container.html('');$.each(items,function(i,item){container.append($.nano(options.basketElementTemplate,item))})}}
if(jQuery.isFunction(options.onFinishedFunc))options.onFinishedFunc(this,cart)}})}}});moduleRegister.pushModule('catalog');var catalogFront=new Class({Extends:x4FrontModule,preventJquery:!1,constructor:function(){this.parent('catalog')},addComparse:function(id){this.connector.execute({addComparse:{id:id}})},removeComparse:function(id){this.connector.execute({removeComparseItem:{id:id}})},getComparseCount:function(id){this.connector.execute({getComparseCount:!0})},getComparseItems:function(id){this.connector.execute({getComparseItems:{}});return this.connector.result.items},getRelativeSku:function(id,propsToFilter){this.connector.execute({getRelativeSku:{id:id,propsToFilter:propsToFilter}});return this.connector.result.relativeSku},jqueryRun:function(){if(this.preventJquery)return;var catalog=this;$.fn.showKeywordSearch=function(options){var defaults={resultContainer:'.showKeywordsContainerResults',minLength:3,onready:null};var options=$.extend(defaults,options);$(this).keyup(function(e){if($(this).val().length<options.minLength){$(options.resultContainer).hide();return}
form=$(this).closest('form');catalog.connector.execute({getKeywordSearch:{moduleId:form.attr('id'),keyword:$(this).val()}},function(a,obj){$(options.resultContainer).html(obj.result.html);$(options.resultContainer).show();if(typeof options.onready=='function')options.onready(e)})})}
$.fn.catalogCurrentComparseCount=function(options){var defaults={onSet:null}
var options=$.extend(defaults,options);catalog.getComparseCount();if(typeof catalog.connector.result.count!='undefined'){rcount=parseInt(catalog.connector.result.count);if(rcount>0){$(this).html(rcount);if(options.onSet){options.onSet($(this),rcount)}}}}
$.fn.catalogAddComparse=function(options){var defaults={idAttribute:'data-id',onAdded:null,onBeforeAdd:null,currentCount:0,maxCount:5,onMaxCount:null,countContainer:'.countComparse'};var options=$.extend(defaults,options);$(this).click(function(e){if(options.maxCount<=options.currentCount){if(options.onMaxCount){options.onMaxCount($(this))}}
if(options.onBeforeAdd($(this),e)){catalog.addComparse($(this).attr(options.idAttribute))}else{catalog.removeComparse($(this).attr(options.idAttribute))}
options.currentCount=catalog.connector.result.count;$(options.countContainer).html(catalog.connector.result.count);if(options.onAdded){options.onAdded($(this),e,catalog.connector.result.count)}})}}});moduleRegister.pushModule('pages');var pagesFront=new Class({Extends:x4FrontModule,preventJquery:!1,constructor:function(){this.parent('pages')},jqueryRun:function(){},renderSlot:function(url,slot,callback){if(callback){this.connector.execute({renderSlot:{url:url,slot:slot}},callback)}else{this.connector.execute({renderSlot:{url:url,slot:slot}});return this.connector.result.slots}}});moduleRegister.pushModule('forms');var formsFront=new Class({Extends:x4FrontModule,preventJquery:!1,constructor:function(){this.parent('forms')},updateCaptcha:function(fid,captcha_inp){if(typeof captcha_inp=='undefined')return!1;if(!fid&&!captcha_inp)return!1;if(!captcha_inp.length)return!1;var captcha_img=jQuery('#'+jQuery.trim(captcha_inp.attr('id'))+'_img');if(!captcha_img.length)return!1;var tmp=new Date();tmp=tmp.getTime();captcha_inp.val('');captcha_img.attr('src','/captcha.php?fid='+fid+'&rand='+tmp)},checkCaptcha:function(field,rules,i,options){if(field.val()==''&&field.attr('maxlength')==field.val().length){return options.allrules.validate2captcha.alertText}else if(field.attr('maxlength')>field.val().length){return options.allrules.minSize.alertText+field.attr('maxlength')+options.allrules.minSize.alertText2}
var formsId=jQuery.trim(field.attr('id'));formsId=formsId.substr(String('captcha_').length,formsId.length);if(!formsId)return!1;var id_num=Number(formsId.substr(String('form').length,formsId.length));this.connector.execute({checkCaptcha:{form:{'id':id_num},params:{'captcha':field.val()}}});if(this.connector.result.captcha==!1){this.updateCaptcha(formsId,field);return options.allrules.validate2captcha.alertText}},jqueryRun:function(){if(this.preventJquery)return;var forms=this;jQuery.fn.updateFormCaptcha=function(options){var defaults={};var options=$.extend(defaults,options);if(typeof options.formId=='undefined'){return!1}
jQuery(this).on('click',function(e){e.preventDefault();forms.updateCaptcha('form'+options.formId,jQuery('#captcha_form'+options.formId))})}
jQuery.fn.submitForm=function(options){var defaults={validateOptions:{promptPosition:"centerRight",scroll:!0,validationEventTrigger:'blur keyup'}};var options=$.extend(defaults,options);if(typeof options.formId=='undefined'){return!1}
var validateForm=jQuery('#'+options.formId).validationEngine('attach',options.validateOptions);if(typeof options.async!='undefined'&&Number(options.async)==1){jQuery(this).on('click',function(e){e.preventDefault();e.stopPropagation();var formValid=validateForm.validationEngine('validate');if(!formValid){return!1}
var formData=xoad.html.exportForm(options.formId);forms.connector.execute({sendFormData:{formId:options.formId,formData:formData}});if(typeof forms.connector.result.success!='undefined'){alert(forms.connector.result.success);jQuery('#'+options.formId)[0].reset();forms.updateCaptcha('form'+options.formId,jQuery('#captcha_form'+options.formId))}else if(typeof forms.connector.result.error=='string'){jQuery('.errors'+options.formId).html(forms.connector.result.error)}else if(typeof forms.connector.result.error=='number'){switch(forms.connector.result.error){case 1:jQuery('.errors'+options.formId).html('Ошибка! Отсутствуют данные для отправки.');break;case 2:jQuery('.errors'+options.formId).html('Ошибка! Отсутствует или не подключён шаблон отправки сообщений. Сообщите об ошибке администрации сайта.');break;default:jQuery('.errors'+options.formId).html('Произошла непридвиденная ошибка при отправке сообщения. Попробуйте отправить сообщение еще раз.');break}}
if(typeof forms.connector.result.error!='undefined'){forms.updateCaptcha('form'+options.formId,jQuery('#captcha_form'+options.formId))}})}else{jQuery(this).on('click',function(e){var formValid=validateForm.validationEngine('validate');if(!formValid){e.preventDefault();e.stopPropagation();return!1}
jQuery(options.formId).on('submit')})}}}});/var/www/html